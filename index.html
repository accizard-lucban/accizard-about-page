<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>Accizard - Report Hazards. Save Lives. Stay Safe.</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800&display=swap" rel="stylesheet">
    <link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>


</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <a href="#" class="logo">
                <img src="2.png" alt="AcciZard Logo">
            </a>
            <div class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul class="nav-links" id="navLinks">
                <li><a href="#about">About</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#screenshots">Demo</a></li>
                <li><a href="#faq">FAQ</a></li>
                <li><a href="#news">News</a></li>
            </ul>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-text">
                <img src="3.png">
            </div>
            <div class="hero-mockup">
                <img src="6.png" alt="Laptop Mockup" class="laptop">
                <img src="5.png" alt="Phone Mockup" class="phone">
            </div>
        </div>
    </section>

    <!-- About Section -->
<section id="about" class="about-section">
  <div class="about-container">
    <!-- Left side logo -->
    <div class="about-logo">
      <img src="7.png" alt="Accizard Logo">
    </div>

    <!-- Right side content -->
    <div class="about-text">
      <h2>ABOUT ACCIZARD</h2>
      <p>
        Welcome to AcciZard Lucban, a cutting-edge web application dedicated to enhancing urban safety in Lucban City. 
        Aligned with UN Sustainable Development Goal 11: Sustainable Cities and Communities, our platform empowers 
        residents to report accidents and track hazards in real-time.
      </p>
      <p>
        Developed by a passionate team of researchers from Southern Luzon State University, AcciZard Lucban fosters 
        collaboration and awareness by providing an easy-to-use interface for hazard monitoring. Together, we aim 
        to create safer, more sustainable communities by bridging technology and public safety.
      </p>
      <p>
        Join us in building a resilient Lucban‚Äîreport, track, and make a difference!
      </p>

      <!-- Buttons -->
      <div class="about-buttons">
        <a href="#contact" class="btn primary-btn">Contact Us</a>
        <a href="#faq" class="btn secondary-btn">Ask a Question</a>
      </div>
    </div>
  </div>
    <!-- Mission & Vision Section -->
  <div class="mission-vision">
    <div class="mission">
      <h3>Mission</h3>
      <p>
        Our mission is to enhance urban safety and resilience in Lucban City by leveraging technology 
        to provide a reliable, user-friendly platform for accident reporting and hazard tracking. 
        We strive to empower residents with tools for real-time awareness, promote active community 
        engagement, and foster a culture of preparedness and collaboration. By aligning with global 
        sustainability goals, we aim to build safer, smarter, and more sustainable communities for 
        current and future generations.
      </p>
    </div>

    <div class="vision">
      <h3>Vision</h3>
      <p>
        We envision AcciZard Lucban as a cornerstone of urban safety in Lucban City, where technology 
        and community collaboration unite to create a safer and more sustainable environment. Our goal 
        is to inspire proactive citizen participation, establish a trusted network for hazard monitoring, 
        and contribute to the development of disaster-resilient cities. Through innovation and dedication, 
        we aspire to be recognized as a model for sustainable urban safety solutions both locally and globally.
      </p>
    </div>
  </div>
</section>


    <!-- Features Section -->
    <section id="features" class="section_features">
        <div class="container">
            <h2 class="section-title">Key Features</h2>
            <p class="section-subtitle">Powerful tools for community safety</p>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üì±</div>
                    <h3 class="feature-title">Mobile Reporting</h3>
                    <p class="feature-description">Capture and submit hazards with photos, videos, and GPS location data instantly.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üåê</div>
                    <h3 class="feature-title">Web Dashboard</h3>
                    <p class="feature-description">Admins monitor and manage reports in real time through our comprehensive web interface.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîî</div>
                    <h3 class="feature-title">Instant Notifications</h3>
                    <p class="feature-description">Real-time alerts keep users aware of hazards and safety updates in their area.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ü§ù</div>
                    <h3 class="feature-title">Community Safety</h3>
                    <p class="feature-description">Built for faster reporting and response, creating safer communities together.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works -->
    <section id="how-it-works" class="section how-it-works">
        <div class="container">
            <h2 class="section-title">How It Works</h2>
            <p class="section-subtitle">Simple 4-step process for safer communities</p>
            <div class="steps-grid">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3 class="step-title">Spot</h3>
                    <p class="step-description">Identify a hazard or safety concern in your area</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3 class="step-title">Report</h3>
                    <p class="step-description">Capture photos, videos and submit with GPS location</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3 class="step-title">Review</h3>
                    <p class="step-description">Admins review and verify the reported incident</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h3 class="step-title">Respond</h3>
                    <p class="step-description">Appropriate action is taken to address the hazard</p>
                </div>
            </div>
        </div>
    </section>



    <!-- Screenshots Section -->
    <section id="screenshots" class="section_ss">
  <div class="container">
    <h2 class="title">Screenshots & Demo Preview</h2>
    <p class="section-subtitle">See Accizard in action</p>

    <div class="screenshots-grid">
      <div class="video-card" data-video="mobapp.mp4">
        <video src="mobapp.mp4" muted loop></video>
        <div class="video-overlay">
          <h3>Mobile App Interface</h3>
          <div class="play-btn">‚ñ∂</div>
        </div>
      </div>

      <div class="video-card" data-video="mobile.mp4">
        <video src="mobile.mp4" muted loop></video>
        <div class="video-overlay">
          <h3>Web Admin Dashboard</h3>
          <div class="play-btn">‚ñ∂</div>
        </div>
      </div>

      <div class="video-card" data-video="report.mp4">
        <video src="mobile.mp4" muted loop></video>
        <div class="video-overlay">
          <h3>Reporting Flow</h3>
          <div class="play-btn">‚ñ∂</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Expanded video popup -->
  <div class="video-popup">
    <div class="video-popup-content">
      <span class="close-btn">&times;</span>
      <video controls autoplay></video>
    </div>
  </div>
</section>
<script>
const videoCards = document.querySelectorAll('.video-card');
const popup = document.querySelector('.video-popup');
const popupVideo = popup.querySelector('video');
const closeBtn = document.querySelector('.close-btn');

videoCards.forEach(card => {
  card.addEventListener('click', () => {
    const videoSrc = card.getAttribute('data-video');
    popupVideo.src = videoSrc;
    popup.classList.add('active');
    popupVideo.play();
  });
});

closeBtn.addEventListener('click', () => {
  popup.classList.remove('active');
  popupVideo.pause();
  popupVideo.currentTime = 0;
});

// Close on background click
popup.addEventListener('click', (e) => {
  if (e.target === popup) {
    popup.classList.remove('active');
    popupVideo.pause();
    popupVideo.currentTime = 0;
  }
});

// Add hover effects for video preview
videoCards.forEach(card => {
  const video = card.querySelector('video');
  
  card.addEventListener('mouseenter', () => {
    video.play();
  });
  
  card.addEventListener('mouseleave', () => {
    video.pause();
    video.currentTime = 0;
  });
});
</script>

   <section id="faq" class="section faq-section">
  <div class="container">
    <div class="faq-header">
      <div>
        <h2>Frequently asked <span>questions</span></h2>
        <p>
          Learn more about Accizard ‚Äî how it works, its features, and how it helps you report and monitor hazards effectively.
        </p>
      </div>
    </div>

    <div class="faq-container">
      <div class="faq-item">
        <button class="faq-question">
          Is Accizard free to use?
          <span class="faq-icon">+</span>
        </button>
        <div class="faq-answer">
          Yes, Accizard offers a free tier for individual users and small communities. We also provide premium plans with advanced features for larger organizations.
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question">
          How accurate is GPS location?
          <span class="faq-icon">+</span>
        </button>
        <div class="faq-answer">
          Our GPS accuracy is typically within 3‚Äì5 meters, ensuring precise location data for all hazard reports. The system also works offline.
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question">
          Can I use Accizard without internet?
          <span class="faq-icon">+</span>
        </button>
        <div class="faq-answer">
          No, Accizard requires an internet connection to log in, submit reports, and sync data with the web dashboard.
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question">
          What types of hazards can be reported?
          <span class="faq-icon">+</span>
        </button>
        <div class="faq-answer">
          Accizard supports reporting of all types of safety hazards including road conditions, infrastructure damage, environmental risks, and emergencies.
        </div>
      </div>

      <div class="faq-item">
  <button class="faq-question">
    How to download the APK of the mobile app?
    <span class="faq-icon">+</span>
  </button>
  <div class="faq-answer">
    You can download the latest version of the Accizard mobile app by clicking the link below. 
    <br><br>
    <a href="accizard.txt" download class="download-link">
      üì± Download Accizard APK
    </a>
  </div>
</div>
    </div>
  </div>
</section>
<script>
const faqItems = document.querySelectorAll('.faq-item');

faqItems.forEach(item => {
  item.querySelector('.faq-question').addEventListener('click', () => {
    item.classList.toggle('active');
    faqItems.forEach(other => {
      if (other !== item) other.classList.remove('active');
    });
  });
});
</script>

    <!-- News Updates Section -->
    <section id="news" class="news-section">
        <div class="container">
            <h2 class="section-title">Latest News Updates</h2>
            <p class="section-subtitle">Stay informed with the latest updates from PAGASA, DOST, and NDRRMC</p>
            
            <div class="news-carousel">
                <button class="carousel-btn prev-btn" id="prevBtn">‚ùÆ</button>
                <button class="carousel-btn next-btn" id="nextBtn">‚ùØ</button>
                <div class="news-container">
                    <!-- News items will be dynamically loaded here by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Accizard</h3>
                    <p>Making communities safer through innovative hazard reporting technology.</p>
                    <div class="social-icons">
                        <div class="social-links">
                        <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-x-twitter"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                        </div>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <a href="mailto:info@accizard.com">info@accizard.com</a>
                    <p>24/7 Support Available</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <a href="#about">About Us</a>
                    <a href="#features">Features</a>
                    <a href="#faq">FAQ</a>
                    <a href="#">Privacy Policy</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Accizard. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
    // NewsData.io API Configuration
    const NEWS_API_KEY = 'pub_e50a94871c1640aaa68bf69837585a15';
    const NEWS_API_URL = 'https://newsdata.io/api/1/news';
    
    // Embedded cache data (works with file:// protocol) - 3 articles per source (9 total)
    window.CACHED_NEWS_DATA = {
      "articles": [
        // PAGASA Articles (3)
        {
          "id": "PAGASA_1728678000_001",
          "title": "PAGASA Issues Weather Advisory for Tropical Depression",
          "description": "The Philippine Atmospheric, Geophysical and Astronomical Services Administration warns of potential flooding in low-lying areas as a tropical depression approaches the eastern seaboard. Residents are advised to monitor weather updates and prepare emergency kits.",
          "link": "https://www.pagasa.dost.gov.ph/tropical-cyclone-bulletin",
          "image": "https://images.unsplash.com/photo-1504608524841-42fe6f032b4b?w=300&h=200&fit=crop&crop=center",
          "source": "PAGASA",
          "time": "1 hour ago",
          "publishedAt": "2024-10-12T11:00:00Z",
          "category": "environment"
        },
        {
          "id": "PAGASA_1728674400_002",
          "title": "Typhoon Season Outlook: Enhanced Monitoring Systems",
          "description": "PAGASA announces deployment of advanced weather monitoring systems across the archipelago to improve typhoon tracking and early warning capabilities for the upcoming season.",
          "link": "https://www.pagasa.dost.gov.ph/climate-monitoring",
          "image": "https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=300&h=200&fit=crop&crop=center",
          "source": "PAGASA",
          "time": "3 hours ago",
          "publishedAt": "2024-10-12T09:00:00Z",
          "category": "environment"
        },
        {
          "id": "PAGASA_1728670800_003",
          "title": "Climate Data Shows Rising Sea Temperatures",
          "description": "Latest oceanographic data reveals significant warming trends in Philippine waters, affecting marine ecosystems and weather patterns nationwide. Scientists urge immediate climate action.",
          "link": "https://www.pagasa.dost.gov.ph/climate-data",
          "image": "https://images.unsplash.com/photo-1611273426858-450d8e3c9fce?w=300&h=200&fit=crop&crop=center",
          "source": "PAGASA",
          "time": "5 hours ago",
          "publishedAt": "2024-10-12T07:00:00Z",
          "category": "environment"
        },
        
        // DOST Articles (3)
        {
          "id": "DOST_1728678000_001",
          "title": "DOST Launches AI-Powered Disaster Early Warning System",
          "description": "Revolutionary artificial intelligence system can predict natural disasters 72 hours in advance, potentially saving thousands of lives. The system integrates weather data, seismic readings, and satellite imagery.",
          "link": "https://www.dost.gov.ph/news/dost-launches-ai-powered-disaster-early-warning-system",
          "image": "https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=300&h=200&fit=crop&crop=center",
          "source": "DOST",
          "time": "2 hours ago",
          "publishedAt": "2024-10-12T10:00:00Z",
          "category": "technology"
        },
        {
          "id": "DOST_1728674400_002",
          "title": "Philippine Space Program Achieves New Milestone",
          "description": "DOST announces successful deployment of advanced Earth observation satellite, enhancing disaster monitoring capabilities. The satellite will provide real-time data for weather forecasting and environmental monitoring.",
          "link": "https://www.dost.gov.ph/news/philippine-space-program-achieves-new-milestone",
          "image": "https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?w=300&h=200&fit=crop&crop=center",
          "source": "DOST",
          "time": "4 hours ago",
          "publishedAt": "2024-10-12T08:00:00Z",
          "category": "technology"
        },
        {
          "id": "DOST_1728670800_003",
          "title": "Breakthrough in Renewable Energy Research",
          "description": "Filipino scientists develop innovative solar panel technology with 40% higher efficiency, promising cheaper clean energy for households and businesses across the Philippines.",
          "link": "https://www.dost.gov.ph/news/breakthrough-in-renewable-energy-research",
          "image": "https://images.unsplash.com/photo-1509391366360-2e959784a276?w=300&h=200&fit=crop&crop=center",
          "source": "DOST",
          "time": "6 hours ago",
          "publishedAt": "2024-10-12T06:00:00Z",
          "category": "technology"
        },
        
        // NDRRMC Articles (3)
        {
          "id": "NDRRMC_1728678000_001",
          "title": "National Earthquake Drill Conducted Nationwide",
          "description": "Millions of Filipinos participate in simultaneous earthquake drill, testing emergency response protocols across all regions. The exercise aims to improve disaster preparedness and response coordination.",
          "link": "https://www.ndrrmc.gov.ph/news/national-earthquake-drill-conducted-nationwide",
          "image": "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=300&h=200&fit=crop&crop=center",
          "source": "NDRRMC",
          "time": "2 hours ago",
          "publishedAt": "2024-10-12T10:00:00Z",
          "category": "health"
        },
        {
          "id": "NDRRMC_1728674400_002",
          "title": "Flood Preparedness Campaign Launched",
          "description": "Comprehensive public awareness campaign educates communities on flood risks and evacuation procedures ahead of rainy season. Local government units receive updated emergency response protocols.",
          "link": "https://www.ndrrmc.gov.ph/news/flood-preparedness-campaign-launched",
          "image": "https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=300&h=200&fit=crop&crop=center",
          "source": "NDRRMC",
          "time": "4 hours ago",
          "publishedAt": "2024-10-12T08:00:00Z",
          "category": "health"
        },
        {
          "id": "NDRRMC_1728670800_003",
          "title": "Emergency Communication System Upgraded",
          "description": "New satellite-based communication network ensures uninterrupted emergency coordination during disasters. The system provides backup communications when traditional networks fail.",
          "link": "https://www.ndrrmc.gov.ph/news/emergency-communication-system-upgraded",
          "image": "https://images.unsplash.com/photo-1581833971358-2c8b550f87b3?w=300&h=200&fit=crop&crop=center",
          "source": "NDRRMC",
          "time": "6 hours ago",
          "publishedAt": "2024-10-12T06:00:00Z",
          "category": "technology"
        }
      ],
      "lastUpdated": "2024-10-12T12:00:00Z",
      "totalArticles": 9,
      "sources": ["DOST", "PAGASA", "NDRRMC"],
      "nextUpdate": "2024-10-13T12:00:00Z"
    };
    
    // News Management System
    class NewsManager {
      constructor() {
        this.newsContainer = document.querySelector('.news-container');
        this.currentIndex = 0;
        this.totalItems = 0;
        this.newsData = [];
        this.isPaused = false;
        this.autoAdvanceInterval = null;
        this.isRefreshing = false;
        
        // Don't get button references here - wait for DOM to be ready
        this.prevBtn = null;
        this.nextBtn = null;
        this.refreshBtn = null;
        
        this.init();
      }
      
      async init() {
        // Load existing news from localStorage or fetch new ones
        await this.loadNews();
        this.setupCarousel();
        this.setupAutoFetch();
      }
      
      async loadNews() {
        try {
          // Load news from cached JSON file
          await this.fetchNewsFromCache();
        } catch (error) {
          console.error('Error loading news:', error);
          this.showNewsStatus('Error loading news. Please try again later.', 'error');
        }
      }
      
      async fetchNewsFromCache() {
        try {
          this.showNewsStatus('Loading latest news...', 'info');
          
          // Try to fetch from Firebase Cloud Function (production)
          try {
            const response = await fetch('https://getnews-4hksadkxba-uc.a.run.app');
            if (response.ok) {
              const newsData = await response.json();
              if (newsData.articles && newsData.articles.length > 0) {
                this.newsData = newsData.articles;
                const lastUpdated = new Date(newsData.fetchedAt).toLocaleString();
                this.showNewsStatus(`‚úÖ Loaded ${newsData.articles.length} latest news articles (Auto-fetched every 5 hours). Updated: ${lastUpdated}`, 'success');
                this.renderNews();
                return;
              }
            }
          } catch (fetchError) {
            console.log('Firebase function not available, trying fallback...', fetchError.message);
          }
          
          // Fallback: try to load from embedded cache data (works with file:// protocol)
          if (window.CACHED_NEWS_DATA) {
            const cachedData = window.CACHED_NEWS_DATA;
            if (cachedData.articles && cachedData.articles.length > 0) {
              this.newsData = cachedData.articles;
              this.showNewsStatus(`üìÑ Loaded ${cachedData.articles.length} sample news articles.`, 'info');
              this.renderNews();
              return;
            }
          }
          
          throw new Error('No cached data available');
          
        } catch (error) {
          console.error('Error loading cached news:', error);
          
          // Only show error message if we don't have any news data yet
          if (!this.newsData || this.newsData.length === 0) {
            this.showNewsStatus('Loading sample news...', 'info');
            // Fallback to sample data if cache fails
            this.loadSampleNews();
          } else {
            console.log('Cache update failed, keeping existing news data');
          }
        }
      }
      
      showNewsStatus(message, type = 'info') {
        console.log(`News Status (${type}): ${message}`);
        
        // Create or update status element
        let statusElement = document.querySelector('.news-status');
        if (!statusElement) {
          statusElement = document.createElement('div');
          statusElement.className = 'news-status';
          
          // Simply append to news section or body - avoid insertBefore issues
          const newsSection = document.querySelector('.news-section');
          if (newsSection) {
            newsSection.appendChild(statusElement);
          } else {
            document.body.appendChild(statusElement);
          }
        }
        
        statusElement.textContent = message;
        statusElement.className = `news-status ${type}`;
        statusElement.style.display = 'block';
        
        // Auto-hide success messages after 5 seconds
        if (type === 'success') {
          setTimeout(() => {
            if (statusElement && statusElement.parentNode) {
              statusElement.style.display = 'none';
            }
          }, 5000);
        }
      }
      
      // Removed old API fetching - now using cached data from Node.js backend
      
      // Utility methods removed - data now comes pre-processed from backend cache
      
      // Fetch counting methods removed - backend handles API rate limiting
      
      formatTime(timestamp) {
        if (!timestamp) return 'Recently';
        
        try {
          const date = new Date(timestamp);
          const now = new Date();
          const diffMs = now - date;
          const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
          const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
          
          if (diffHours < 1) {
            const diffMins = Math.floor(diffMs / (1000 * 60));
            return diffMins <= 0 ? 'Just now' : `${diffMins} minutes ago`;
          } else if (diffHours < 24) {
            return `${diffHours} hour${diffHours === 1 ? '' : 's'} ago`;
          } else if (diffDays < 7) {
            return `${diffDays} day${diffDays === 1 ? '' : 's'} ago`;
          } else {
            return date.toLocaleDateString();
          }
        } catch (error) {
          console.error('Error formatting time:', error);
          return 'Recently';
        }
      }
      
      renderNews() {
        this.newsContainer.innerHTML = '';
        
        this.newsData.forEach((article, index) => {
          const newsItem = document.createElement('div');
          newsItem.className = 'news-item';
          newsItem.setAttribute('data-source', article.source);
          
          // Truncate description for initial display
          const shortDescription = article.description.length > 150 
            ? article.description.substring(0, 150) + '...' 
            : article.description;
          
          const needsSeeMore = article.description.length > 150;
          
          newsItem.innerHTML = `
            <div class="news-image">
              <img src="${article.image}" alt="${article.title}" onload="this.classList.add('loaded')" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0xMjAgODBIMTgwVjEyMEgxMjBWODBaIiBmaWxsPSIjQ0NDIi8+CjxjaXJjbGUgY3g9IjE0MCIgY3k9IjkwIiByPSI1IiBmaWxsPSIjOTk5Ii8+CjxwYXRoIGQ9Ik0xMzAgMTEwTDE0NSA5NUwxNjAgMTEwSDE3MFYxMjBIMTMwVjExMFoiIGZpbGw9IiM5OTkiLz4KPHRleHQgeD0iMTUwIiB5PSIxNTAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM2NjYiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiPk5ld3MgSW1hZ2U8L3RleHQ+Cjwvc3ZnPgo='; this.classList.add('loaded')" loading="lazy">
            </div>
            <div class="news-content">
              <div class="news-source ${article.source}">${article.source}</div>
              <h3 class="news-title">${article.title}</h3>
              <div class="news-description collapsed" data-full="${article.description}" data-short="${shortDescription}">
                <div class="text-content">${shortDescription}</div>
              </div>
              ${needsSeeMore ? '<button class="see-more-btn">See more</button>' : ''}
              <div class="news-meta">
                <span class="news-time">${this.formatTime(article.publishedAt || article.time)}</span>
                <a href="${article.url || article.link}" target="_blank" class="news-link">Read More</a>
              </div>
            </div>
          `;
          
          this.newsContainer.appendChild(newsItem);
          
          // Add see more functionality
          if (needsSeeMore) {
            const seeMoreBtn = newsItem.querySelector('.see-more-btn');
            const description = newsItem.querySelector('.news-description');
            
            seeMoreBtn.addEventListener('click', () => {
              if (description.classList.contains('collapsed')) {
                description.classList.remove('collapsed');
                description.innerHTML = `<div class="text-content">${article.description}</div>`;
                seeMoreBtn.textContent = 'See less';
                this.pauseAutoAdvance(); // Pause auto-advance when expanding
              } else {
                description.classList.add('collapsed');
                description.innerHTML = `<div class="text-content">${shortDescription}</div>`;
                seeMoreBtn.textContent = 'See more';
                this.resumeAutoAdvance(); // Resume auto-advance when collapsing
              }
            });
          }
        });
        
        this.totalItems = this.newsData.length;
        this.currentIndex = 0;
        this.updateCarousel();
      }
      
      setupCarousel() {
        console.log('Setting up carousel...');
        
        // Set up navigation buttons with multiple attempts
        this.setupNavigationButtons();
        
        // Auto-advance carousel every 8 seconds
        this.startAutoAdvance();
      }
      
      setupNavigationButtons() {
        console.log('Setting up carousel navigation buttons...');
        
        // Wait for DOM and then setup buttons
        setTimeout(() => {
          this.prevBtn = document.getElementById('prevBtn');
          this.nextBtn = document.getElementById('nextBtn');
          
          if (this.prevBtn && this.nextBtn) {
            console.log('‚úÖ Carousel buttons found!');
            
            this.prevBtn.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              console.log('üîô Previous carousel button clicked!');
              this.prevSlide();
              this.pauseAutoAdvance();
              setTimeout(() => this.resumeAutoAdvance(), 5000);
            });
            
            this.nextBtn.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              console.log('‚ñ∂Ô∏è Next carousel button clicked!');
              this.nextSlide();
              this.pauseAutoAdvance();
              setTimeout(() => this.resumeAutoAdvance(), 5000);
            });
            
            console.log('‚úÖ Carousel navigation ready!');
          } else {
            console.error('‚ùå Carousel buttons not found');
          }
        }, 500);
      }
      
      prevSlide() {
        if (this.newsData.length <= 1) return;
        
        this.currentIndex = this.currentIndex > 0 ? this.currentIndex - 1 : this.newsData.length - 1;
        this.updateCarousel();
        console.log(`Previous slide: ${this.currentIndex + 1}/${this.newsData.length}`);
      }
      
      nextSlide() {
        if (this.newsData.length <= 1) return;
        
        this.currentIndex = this.currentIndex < this.newsData.length - 1 ? this.currentIndex + 1 : 0;
        this.updateCarousel();
        console.log(`Next slide: ${this.currentIndex + 1}/${this.newsData.length}`);
      }
      
      startAutoAdvance() {
        // Clear any existing interval first
        if (this.autoAdvanceInterval) {
          clearInterval(this.autoAdvanceInterval);
        }
        
        console.log('üîÑ Starting auto-advance (8 second intervals)');
        this.autoAdvanceInterval = setInterval(() => {
          if (!this.isPaused && this.newsData.length > 1) {
            console.log('‚è≠Ô∏è Auto-advancing to next slide...');
            this.nextSlide();
          }
        }, 8000);
      }
      
      pauseAutoAdvance() {
        console.log('‚è∏Ô∏è Auto-advance paused');
        this.isPaused = true;
        // Clear the interval to completely stop auto-advance
        if (this.autoAdvanceInterval) {
          clearInterval(this.autoAdvanceInterval);
          this.autoAdvanceInterval = null;
        }
      }
      
      resumeAutoAdvance() {
        console.log('‚ñ∂Ô∏è Auto-advance resumed');
        this.isPaused = false;
        // Restart the interval
        this.startAutoAdvance();
      }
      
      setupAutoFetch() {
        // Check for cache updates every 5 minutes (reduced from 30 minutes for testing)
        setInterval(async () => {
          console.log('Checking for news cache updates...');
          try {
            await this.fetchNewsFromCache();
          } catch (error) {
            console.log('Auto-refresh failed, will try again later:', error.message);
          }
        }, 5 * 60 * 1000); // 5 minutes in milliseconds
      }
      
      updateCarousel() {
        if (this.newsData.length === 0) {
          console.log('No news data available for carousel');
          return;
        }
        
        // Show only the current news item
        const newsItems = this.newsContainer.querySelectorAll('.news-item');
        console.log(`Found ${newsItems.length} news items in DOM`);
        
        if (newsItems.length === 0) {
          console.log('No news items found in DOM');
          return;
        }
        
        newsItems.forEach((item, index) => {
          if (index === this.currentIndex) {
            item.style.display = 'flex';
            item.style.opacity = '1';
          } else {
            item.style.display = 'none';
            item.style.opacity = '0';
          }
        });
        
        console.log(`Showing article ${this.currentIndex + 1} of ${this.newsData.length}`);
        
        // Update navigation button states
        if (this.prevBtn) {
          this.prevBtn.disabled = false;
        }
        if (this.nextBtn) {
          this.nextBtn.disabled = false;
        }
      }
      
      async manualRefresh() {
        if (this.isRefreshing) {
          return; // Prevent multiple simultaneous refreshes
        }
        
        this.isRefreshing = true;
        this.refreshBtn.disabled = true;
        this.refreshBtn.classList.add('loading');
        this.refreshBtn.textContent = 'üîÑ Refreshing...';
        
        try {
          this.showNewsStatus('Fetching latest news...', 'info');
          
          // In a real implementation, this would trigger the backend news fetcher
          // For now, we'll simulate a refresh by reloading the cached data
          await new Promise(resolve => setTimeout(resolve, 2000)); // Simulate API call
          
          await this.fetchNewsFromCache();
          this.showNewsStatus('‚úÖ News refreshed successfully!', 'success');
          
        } catch (error) {
          console.error('Manual refresh failed:', error);
          this.showNewsStatus('‚ùå Failed to refresh news. Please try again.', 'error');
        } finally {
          this.isRefreshing = false;
          this.refreshBtn.disabled = false;
          this.refreshBtn.classList.remove('loading');
          this.refreshBtn.textContent = 'üîÑ Refresh';
          
          // Hide status after 3 seconds
          setTimeout(() => {
            const statusElement = document.querySelector('.news-status');
            if (statusElement) {
              statusElement.remove();
            }
          }, 3000);
        }
      }
      
      loadSampleNews() {
        // Fallback sample news if API fails
        this.newsData = [
          {
            id: 1,
            title: 'PAGASA Issues Weather Advisory for Tropical Depression',
            description: 'The Philippine Atmospheric, Geophysical and Astronomical Services Administration warns of potential flooding in low-lying areas.',
            image: 'https://via.placeholder.com/300x200?text=Weather+Alert',
            link: 'https://www.pagasa.dost.gov.ph',
            source: 'PAGASA',
            time: '2 hours ago'
          },
          {
            id: 2,
            title: 'DOST Launches New Disaster Monitoring Technology',
            description: 'Department of Science and Technology introduces advanced early warning systems for better disaster preparedness.',
            image: 'https://via.placeholder.com/300x200?text=Technology+Update',
            link: 'https://www.dost.gov.ph',
            source: 'DOST',
            time: '4 hours ago'
          }
        ];
        this.renderNews();
      }
    }
    
    // Force mobile layout for in-app browsers
    function forceMobileLayout() {
      const isMobile = window.innerWidth <= 768 || 
                      /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                      /Messenger|FBAN|FBAV/i.test(navigator.userAgent) || // Facebook/Messenger
                      /vivo/i.test(navigator.userAgent); // Vivo browser
      
      if (isMobile) {
        document.body.classList.add('mobile-layout');
        console.log('üî• Mobile layout forced for in-app browser');
      }
    }

    // Mobile Navigation Toggle
    document.addEventListener('DOMContentLoaded', () => {
      console.log('DOM loaded, initializing News Manager...');
      
      // Force mobile layout first
      forceMobileLayout();
      
      new NewsManager();
      
      // Mobile menu toggle with debugging
      const navToggle = document.getElementById('navToggle');
      const navLinks = document.getElementById('navLinks');
      
      console.log('NavToggle found:', navToggle);
      console.log('NavLinks found:', navLinks);
      
      if (navToggle && navLinks) {
        console.log('‚úÖ Mobile navigation elements found, setting up event listeners...');
        
        navToggle.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          console.log('üçî Hamburger menu clicked!');
          
          const isActive = navToggle.classList.contains('active');
          console.log('Current state:', isActive ? 'open' : 'closed');
          
          navToggle.classList.toggle('active');
          navLinks.classList.toggle('active');
          
          console.log('New state:', navToggle.classList.contains('active') ? 'open' : 'closed');
        });
        
        // Close menu when clicking on a link
        navLinks.querySelectorAll('a').forEach(link => {
          link.addEventListener('click', () => {
            console.log('üì± Menu link clicked, closing menu...');
            navToggle.classList.remove('active');
            navLinks.classList.remove('active');
          });
        });
        
        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
          if (!navToggle.contains(e.target) && !navLinks.contains(e.target)) {
            if (navToggle.classList.contains('active')) {
              console.log('üëÜ Clicked outside menu, closing...');
              navToggle.classList.remove('active');
              navLinks.classList.remove('active');
            }
          }
        });
        
        console.log('‚úÖ Mobile navigation setup complete!');
      } else {
        console.error('‚ùå Mobile navigation elements not found!');
        console.log('Available elements:', {
          navToggle: document.getElementById('navToggle'),
          navLinks: document.getElementById('navLinks')
        });
      }
    });
    </script>

    <script src="script.js"></script>
</body>
</html>